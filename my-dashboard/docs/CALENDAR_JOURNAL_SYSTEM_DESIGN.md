# 📅 캘린더 일지 관리 시스템 기획서

## 1. 개요

### 1.1 목적
- 마크다운 형식의 통합 일지를 캘린더에 자동으로 파싱하여 날짜별로 정리
- 각 날짜의 작업을 상태별, 태그별로 분류하여 효율적으로 관리
- 태그 기반 분석 및 조합 검색 기능 제공

### 1.2 핵심 기능
1. **일지 자동 파싱**: 마크다운 일지를 붙여넣으면 날짜별로 자동 분류
2. **상태별 분류**: 해야할일, 하는중인일, 했던일로 작업 상태 관리
3. **태그 시스템**: 작업 유형, 프로젝트, 카테고리 등을 태그로 분류
4. **분석 기능**: 태그별 그룹화, 조합 검색, 통계 분석
5. **할일 관리**: 다음날 할일, 앞으로 해야할일 메모

---

## 2. 데이터 구조 설계

### 2.1 일지 항목 (JournalEntry)

```typescript
interface JournalEntry {
  id: string;                    // 고유 ID
  featureId: string;              // 캘린더 기능 ID
  userId: string;                 // 사용자 ID
  date: Date;                    // 날짜 (YYYY-MM-DD)
  
  // 기본 정보
  title: string;                  // 제목 (날짜 또는 자동 생성)
  content: string;                // 원본 마크다운 내용
  
  // 상태 분류
  status: 'todo' | 'in_progress' | 'done';  // 해야할일, 하는중, 했던일
  
  // 카테고리 (기존 마크다운 구조에서 추출)
  category?: string;              // 예: "회사 업무", "개인 프로젝트", "휴무"
  subCategory?: string;           // 예: "EDR 학습", "환경 구축"
  
  // 태그 시스템
  tags: string[];                 // 태그 배열 (예: ["EDR", "리눅스", "학습"])
  workTypeTags?: string[];        // 작업 유형 태그 (예: ["문서분석", "테스트", "개발"])
  projectTags?: string[];         // 프로젝트 태그 (예: ["옵티몬", "웹서버"])
  
  // 할일 관리
  isTodo?: boolean;               // 할일 여부
  isFutureTodo?: boolean;         // 앞으로 해야할일 여부
  todoDate?: Date;                // 할일 예정일
  
  // 메타데이터
  createdAt: Date;
  updatedAt: Date;
  color?: string;                 // 캘린더 표시 색상
}
```

### 2.2 태그 마스터 (TagMaster)

```typescript
interface TagMaster {
  id: string;
  userId: string;
  name: string;                   // 태그 이름
  type: 'general' | 'work_type' | 'project';  // 태그 타입
  color?: string;                 // 태그 색상
  createdAt: Date;
}
```

### 2.3 파싱된 일지 구조 (ParsedJournal)

```typescript
interface ParsedJournal {
  date: Date;                     // 날짜
  entries: JournalEntry[];        // 해당 날짜의 모든 항목
  summary?: string;               // 요약 (선택사항)
}
```

---

## 3. 화면 구성 설계

### 3.1 메인 캘린더 화면

#### 레이아웃
```
┌─────────────────────────────────────────────────────────┐
│  [←] 2025년 12월  [오늘]  [일지 붙여넣기]  [분석]  [설정] │
├─────────────────────────────────────────────────────────┤
│  일  월  화  수  목  금  토                              │
│  ┌──┐ ┌──┐ ┌──┐ ┌──┐ ┌──┐ ┌──┐ ┌──┐                    │
│  │  │ │  │ │  │ │  │ │  │ │  │ │  │                    │
│  │ 1│ │ 2│ │ 3│ │ 4│ │ 5│ │ 6│ │ 7│                    │
│  │📝│ │📝│ │  │ │📝│ │  │ │  │ │  │                    │
│  │2개│ │1개│ │  │ │3개│ │  │ │  │ │  │                    │
│  └──┘ └──┘ └──┘ └──┘ └──┘ └──┘ └──┘                    │
│  ...                                                     │
└─────────────────────────────────────────────────────────┘
```

#### 기능
- 월별 캘린더 뷰
- 날짜별 일지 항목 개수 표시
- 날짜 클릭 시 상세 화면 열기
- 일지 붙여넣기 버튼 (모달)

---

### 3.2 일지 붙여넣기 모달

#### 레이아웃
```
┌─────────────────────────────────────────────┐
│  일지 붙여넣기                          [X] │
├─────────────────────────────────────────────┤
│  [마크다운 일지 내용을 붙여넣으세요]        │
│  ┌─────────────────────────────────────┐   │
│  │ ## 2025년 10월 15일 (수요일)        │   │
│  │ ### 회사 업무                        │   │
│  │ - **사무실 가구 배치** ...          │   │
│  │ ...                                  │   │
│  └─────────────────────────────────────┘   │
│                                            │
│  [파싱 옵션]                               │
│  ☑ 날짜 자동 감지                          │
│  ☑ 카테고리 자동 추출                      │
│  ☑ 항목별로 분리                          │
│                                            │
│  [미리보기]                                │
│  📅 2025-10-15: 3개 항목                  │
│  📅 2025-10-16: 2개 항목                  │
│  ...                                       │
│                                            │
│  [취소]  [파싱 및 저장]                    │
└─────────────────────────────────────────────┘
```

#### 기능
- 마크다운 텍스트 붙여넣기
- 자동 날짜 파싱 (## 2025년 10월 15일 형식)
- 카테고리 추출 (### 회사 업무 형식)
- 항목별 분리 및 미리보기
- 파싱 결과 확인 후 저장

---

### 3.3 날짜 상세 화면

#### 레이아웃
```
┌─────────────────────────────────────────────────────────┐
│  📅 2025년 10월 15일 (수요일)                    [닫기] │
├─────────────────────────────────────────────────────────┤
│  [탭: 전체 | 해야할일 | 하는중 | 했던일]                │
├─────────────────────────────────────────────────────────┤
│  [필터: 태그 선택] [검색: ...]  [+ 항목 추가]           │
├─────────────────────────────────────────────────────────┤
│                                                          │
│  ┌──────────────────────────────────────────────────┐  │
│  │ 📌 회사 업무 - EDR 학습                          │  │
│  │ 태그: [EDR] [학습] [문서분석]                    │  │
│  │ 상태: [했던일 ✓]                                 │  │
│  │ ──────────────────────────────────────────────── │  │
│  │ **Genian EDR 관리자 메뉴얼 확인**                │  │
│  │ - 목적: 업무 파악 및 자체 학습                   │  │
│  │ - 배경: 회사에서 EDR과 유사한 엔드포인트...      │  │
│  │                                 [수정] [삭제]    │  │
│  └──────────────────────────────────────────────────┘  │
│                                                          │
│  ┌──────────────────────────────────────────────────┐  │
│  │ 📌 회사 업무 - 환경 구축                          │  │
│  │ 태그: [환경구축] [노트북]                         │  │
│  │ 상태: [했던일 ✓]                                 │  │
│  │ ──────────────────────────────────────────────── │  │
│  │ **회사 노트북 발급** - 개인 업무용 노트북 수령    │  │
│  │                                 [수정] [삭제]    │  │
│  └──────────────────────────────────────────────────┘  │
│                                                          │
└─────────────────────────────────────────────────────────┘
```

#### 기능
- 탭으로 상태별 필터링 (전체/해야할일/하는중/했던일)
- 태그 필터링 및 검색
- 항목 추가/수정/삭제
- 각 항목의 상태 변경 (드래그 앤 드롭 또는 버튼)
- 태그 추가/제거

---

### 3.4 항목 편집 모달

#### 레이아웃
```
┌─────────────────────────────────────────────┐
│  항목 편집                              [X] │
├─────────────────────────────────────────────┤
│  날짜: 2025-10-15                          │
│                                            │
│  카테고리: [회사 업무 ▼]                   │
│  하위 카테고리: [EDR 학습 ▼]               │
│                                            │
│  제목: [Genian EDR 관리자 메뉴얼 확인]      │
│                                            │
│  내용:                                      │
│  ┌─────────────────────────────────────┐   │
│  │ - 목적: 업무 파악 및 자체 학습      │   │
│  │ - 배경: 회사에서 EDR과 유사한...    │   │
│  └─────────────────────────────────────┘   │
│                                            │
│  상태: ○ 해야할일  ○ 하는중  ● 했던일     │
│                                            │
│  태그:                                      │
│  [EDR] [학습] [문서분석] [+ 태그 추가]     │
│                                            │
│  작업 유형:                                 │
│  [문서분석] [테스트] [+ 추가]              │
│                                            │
│  프로젝트:                                  │
│  [옵티몬] [+ 추가]                         │
│                                            │
│  ☑ 할일로 표시                             │
│  ☐ 앞으로 해야할일                         │
│                                            │
│  [취소]  [저장]                            │
└─────────────────────────────────────────────┘
```

---

### 3.5 분석 화면

#### 레이아웃
```
┌─────────────────────────────────────────────────────────┐
│  📊 일지 분석                                        [X] │
├─────────────────────────────────────────────────────────┤
│  [기간 선택] [2025-10-01 ~ 2025-12-31] [1개월] [1년]   │
├─────────────────────────────────────────────────────────┤
│  [탭: 태그 분석 | 조합 검색 | 통계 | 할일 관리]         │
├─────────────────────────────────────────────────────────┤
│                                                          │
│  ┌─ 태그별 분류 ───────────────────────────────────┐  │
│  │ [EDR] (15개)  [리눅스] (12개)  [학습] (20개)    │  │
│  │ [문서분석] (8개)  [테스트] (10개)  ...           │  │
│  │                                                  │  │
│  │ 선택된 태그: [EDR] [학습]                       │  │
│  │ ┌──────────────────────────────────────────┐  │  │
│  │ │ 📅 2025-10-15: Genian EDR 관리자 메뉴얼...│  │  │
│  │ │ 📅 2025-10-16: EDR 로그 구조 이해...      │  │  │
│  │ │ ...                                        │  │  │
│  │ └──────────────────────────────────────────┘  │  │
│  └──────────────────────────────────────────────┘  │
│                                                          │
│  ┌─ 조합 검색 ────────────────────────────────────┐  │
│  │ 태그 1: [EDR ▼]  태그 2: [학습 ▼]  [+ 추가]   │  │
│  │ [검색]                                          │  │
│  │                                                  │  │
│  │ 결과: 8개 항목                                  │  │
│  │ ┌──────────────────────────────────────────┐  │  │
│  │ │ ...                                        │  │  │
│  │ └──────────────────────────────────────────┘  │  │
│  └──────────────────────────────────────────────┘  │
│                                                          │
└─────────────────────────────────────────────────────────┘
```

#### 기능
- 기간별 필터링 (1개월, 3개월, 6개월, 1년)
- 태그별 그룹화 및 통계
- 여러 태그 조합 검색
- 할일 관리 (다음날 할일, 앞으로 해야할일 목록)
- 통계 차트 (태그별 빈도, 상태별 분포 등)

---

## 4. 마크다운 파싱 로직

### 4.1 파싱 규칙

```typescript
// 날짜 파싱
const datePattern = /^##\s+(\d{4})년\s+(\d{1,2})월\s+(\d{1,2})일/;

// 카테고리 파싱
const categoryPattern = /^###\s+(.+?)(?:\s*-\s*(.+))?$/;

// 항목 파싱
const itemPattern = /^-\s+\*\*(.+?)\*\*\s*-\s*(.+)$/;
```

### 4.2 파싱 예시

**입력:**
```markdown
## 2025년 10월 15일 (수요일) - 입사일

### 회사 업무

- **사무실 가구 배치** - 신규 입사일로 회사 사무실에 가구가 처음 들어오는 날이었고, 회사 사람들과 함께 가구 배치 작업 진행
- **니즈소프트 입사** - 정규직 입사. 초기 업무는 기술영업 쪽으로 배정받았으며, 향후 프론트엔드 개발 역할로 전환 예정
```

**출력:**
```typescript
[
  {
    date: "2025-10-15",
    category: "회사 업무",
    subCategory: null,
    title: "사무실 가구 배치",
    content: "신규 입사일로 회사 사무실에 가구가 처음 들어오는 날이었고, 회사 사람들과 함께 가구 배치 작업 진행",
    status: "done", // 기본값
    tags: []
  },
  {
    date: "2025-10-15",
    category: "회사 업무",
    subCategory: null,
    title: "니즈소프트 입사",
    content: "정규직 입사. 초기 업무는 기술영업 쪽으로 배정받았으며, 향후 프론트엔드 개발 역할로 전환 예정",
    status: "done",
    tags: []
  }
]
```

---

## 5. 데이터베이스 구조 (Firestore)

### 5.1 컬렉션 구조

```
calendarJournals/
  {journalId}/
    - id: string
    - featureId: string
    - userId: string
    - date: Timestamp
    - title: string
    - content: string
    - status: string
    - category: string
    - subCategory: string
    - tags: string[]
    - workTypeTags: string[]
    - projectTags: string[]
    - isTodo: boolean
    - isFutureTodo: boolean
    - todoDate: Timestamp
    - color: string
    - createdAt: Timestamp
    - updatedAt: Timestamp

tagMasters/
  {tagId}/
    - id: string
    - userId: string
    - name: string
    - type: string
    - color: string
    - createdAt: Timestamp
```

### 5.2 인덱스

- `calendarJournals`: `userId` (asc), `date` (desc)
- `calendarJournals`: `userId` (asc), `status` (asc), `date` (desc)
- `calendarJournals`: `userId` (asc), `tags` (array-contains), `date` (desc)

---

## 6. 구현 단계

### Phase 1: 기본 구조
1. ✅ 캘린더 UI 기본 구조
2. ⏳ 데이터 모델 정의
3. ⏳ Firestore 연동
4. ⏳ 날짜별 항목 표시

### Phase 2: 일지 파싱
1. ⏳ 마크다운 파싱 로직 구현
2. ⏳ 일지 붙여넣기 모달
3. ⏳ 파싱 결과 미리보기
4. ⏳ 데이터 저장

### Phase 3: 상세 관리
1. ⏳ 날짜 상세 화면
2. ⏳ 항목 추가/수정/삭제
3. ⏳ 상태 변경 기능
4. ⏳ 태그 추가/제거

### Phase 4: 분석 기능
1. ⏳ 태그별 그룹화
2. ⏳ 조합 검색
3. ⏳ 통계 차트
4. ⏳ 할일 관리

---

## 7. UI/UX 고려사항

### 7.1 색상 체계
- **해야할일**: 빨간색 계열 (#ef4444)
- **하는중**: 노란색 계열 (#f59e0b)
- **했던일**: 초록색 계열 (#10b981)
- **태그별**: 사용자 정의 색상

### 7.2 반응형 디자인
- 모바일: 리스트 뷰 우선
- 태블릿: 캘린더 + 상세 분할
- 데스크톱: 전체 기능 표시

### 7.3 접근성
- 키보드 네비게이션 지원
- 스크린 리더 지원
- 색상 대비 준수

---

## 8. 향후 확장 기능

1. **템플릿 시스템**: 자주 사용하는 카테고리/태그 템플릿
2. **내보내기**: 마크다운, PDF, Excel 형식으로 내보내기
3. **알림**: 할일 알림 기능
4. **공유**: 다른 사용자와 일지 공유
5. **AI 분석**: 태그 자동 추천, 유사 항목 추천

---

## 9. 참고사항

- 기존 세계시간 기능과 동일한 구조로 구현
- `featureId`를 통해 각 캘린더 인스턴스 구분
- 사용자별 데이터 격리 (userId 기반)
- 실시간 동기화 (Firestore onSnapshot)

