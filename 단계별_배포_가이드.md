# ğŸš€ ë‹¨ê³„ë³„ ë°°í¬ ê°€ì´ë“œ - Git + CI/CD ìë™ ë°°í¬

ì´ ê°€ì´ë“œëŠ” FTP í”„ë¡œì íŠ¸ë¥¼ Git ê¸°ë°˜ ìë™ ë°°í¬ ì‹œìŠ¤í…œìœ¼ë¡œ ì „í™˜í•˜ëŠ” ì „ì²´ ê³¼ì •ì„ ìˆœì„œëŒ€ë¡œ ì•ˆë‚´í•©ë‹ˆë‹¤.

---

## ğŸ“‹ ëª©ì°¨

1. [í”„ë¡œì íŠ¸ êµ¬ì¡° ì •ë¦¬ (ë””ìì¸ íŒ¨í„´ ì ìš©)](#1-í”„ë¡œì íŠ¸-êµ¬ì¡°-ì •ë¦¬-ë””ìì¸-íŒ¨í„´-ì ìš©)
2. [Git ì„¤ì¹˜ ë° ì €ì¥ì†Œ ì´ˆê¸°í™”](#2-git-ì„¤ì¹˜-ë°-ì €ì¥ì†Œ-ì´ˆê¸°í™”)
3. [í”„ë¡œì íŠ¸ íŒŒì¼ ì •ë¦¬ ë° ì»¤ë°‹](#3-í”„ë¡œì íŠ¸-íŒŒì¼-ì •ë¦¬-ë°-ì»¤ë°‹)
4. [ì›ê²© Git ì €ì¥ì†Œ ì—°ê²°](#4-ì›ê²©-git-ì €ì¥ì†Œ-ì—°ê²°)
5. [ì„œë²„ ì¤€ë¹„ (ë°°í¬ ì‚¬ìš©ì ë° ë””ë ‰í† ë¦¬)](#5-ì„œë²„-ì¤€ë¹„-ë°°í¬-ì‚¬ìš©ì-ë°-ë””ë ‰í† ë¦¬)
6. [ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±](#6-ë°°í¬-ìŠ¤í¬ë¦½íŠ¸-ì‘ì„±)
7. [GitHub Actions CI/CD ì„¤ì •](#7-github-actions-cicd-ì„¤ì •)
8. [ìë™ ë°°í¬ í…ŒìŠ¤íŠ¸](#8-ìë™-ë°°í¬-í…ŒìŠ¤íŠ¸)
9. [ìˆ˜ë™ ë°°í¬ ë°©ë²• (Git ì—†ì„ ë•Œ)](#9-ìˆ˜ë™-ë°°í¬-ë°©ë²•-git-ì—†ì„-ë•Œ)

---

## 1. í”„ë¡œì íŠ¸ êµ¬ì¡° ì •ë¦¬ (ë””ìì¸ íŒ¨í„´ ì ìš©)

### í˜„ì¬ êµ¬ì¡°
```
C:\FTP\
â”œâ”€â”€ index.html          # ë©”ì¸ í˜ì´ì§€ (ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ í¬í•¨)
â”œâ”€â”€ world_time.html     # ì„¸ê³„ ì‹œê°„ í˜ì´ì§€
â”œâ”€â”€ disk_info.php       # ë””ìŠ¤í¬ ì •ë³´ í˜ì´ì§€
â”œâ”€â”€ gallery.php         # ê°¤ëŸ¬ë¦¬ í˜ì´ì§€
â””â”€â”€ ...
```

### ëª©í‘œ êµ¬ì¡° (ë””ìì¸ íŒ¨í„´ ì ìš©)
```
C:\FTP\
â”œâ”€â”€ public\                    # ì›¹ ì„œë²„ì— ë°°í¬ë  íŒŒì¼ë“¤
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ world_time.html
â”‚   â”œâ”€â”€ disk_info.php
â”‚   â”œâ”€â”€ gallery.php
â”‚   â”œâ”€â”€ css\                   # ìŠ¤íƒ€ì¼ì‹œíŠ¸ ë¶„ë¦¬
â”‚   â”‚   â”œâ”€â”€ style.css          # ê³µí†µ ìŠ¤íƒ€ì¼
â”‚   â”‚   â”œâ”€â”€ index.css
â”‚   â”‚   â”œâ”€â”€ gallery.css
â”‚   â”‚   â””â”€â”€ disk.css
â”‚   â”œâ”€â”€ js\                    # JavaScript ë¶„ë¦¬
â”‚   â”‚   â”œâ”€â”€ common.js          # ê³µí†µ í•¨ìˆ˜
â”‚   â”‚   â”œâ”€â”€ world-time.js
â”‚   â”‚   â””â”€â”€ gallery.js
â”‚   â””â”€â”€ images\                # ì´ë¯¸ì§€ íŒŒì¼
â”‚       â”œâ”€â”€ icons\
â”‚       â””â”€â”€ thumbnails\
â”œâ”€â”€ deploy\                    # ë°°í¬ ê´€ë ¨ ìŠ¤í¬ë¦½íŠ¸
â”‚   â”œâ”€â”€ deploy.sh              # ì„œë²„ ë°°í¬ ìŠ¤í¬ë¦½íŠ¸
â”‚   â””â”€â”€ manual_deploy.sh       # ìˆ˜ë™ ë°°í¬ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ .github\
â”‚   â””â”€â”€ workflows\
â”‚       â””â”€â”€ deploy.yml         # GitHub Actions ì›Œí¬í”Œë¡œìš°
â”œâ”€â”€ .gitignore                 # Git ì œì™¸ íŒŒì¼
â”œâ”€â”€ README.md
â””â”€â”€ ë°°í¬ë°©ë²•.md
```

### êµ¬ì¡° ì •ë¦¬ ëª…ë ¹ì–´ (Windows PowerShell)

**ë°©ë²• 1: ìë™ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ (ê¶Œì¥)**
```powershell
# ì‹¤í–‰ ì •ì±… ìš°íšŒí•˜ì—¬ ì‹¤í–‰
powershell -ExecutionPolicy Bypass -File .\ë°°í¬_ì‹œì‘í•˜ê¸°.ps1

# ë˜ëŠ” ë°°ì¹˜ íŒŒì¼ ì‚¬ìš©
ë°°í¬_ì‹œì‘í•˜ê¸°_ì•ˆì „ì‹¤í–‰.bat
```

**ë°©ë²• 2: ìˆ˜ë™ìœ¼ë¡œ ì‹¤í–‰**
```powershell
# 1. ìƒˆ ë””ë ‰í† ë¦¬ êµ¬ì¡° ìƒì„±
New-Item -ItemType Directory -Force -Path "public\css"
New-Item -ItemType Directory -Force -Path "public\js"
New-Item -ItemType Directory -Force -Path "public\images\icons"
New-Item -ItemType Directory -Force -Path "public\images\thumbnails"
New-Item -ItemType Directory -Force -Path "deploy"
New-Item -ItemType Directory -Force -Path ".github\workflows"

# 2. ê¸°ì¡´ íŒŒì¼ì„ public ë””ë ‰í† ë¦¬ë¡œ ì´ë™
Move-Item -Path "index.html" -Destination "public\index.html" -Force
Move-Item -Path "world_time.html" -Destination "public\world_time.html" -Force
Move-Item -Path "disk_info.php" -Destination "public\disk_info.php" -Force
Move-Item -Path "gallery.php" -Destination "public\gallery.php" -Force

# 3. CSS/JS ë¶„ë¦¬ ì‘ì—…ì€ ë‹¤ìŒ ë‹¨ê³„ì—ì„œ ì§„í–‰
```

---

## 2. Git ì„¤ì¹˜ ë° ì €ì¥ì†Œ ì´ˆê¸°í™”

### 2-1. Git ì„¤ì¹˜ (Windows)

#### ë°©ë²• 1: ê³µì‹ ì›¹ì‚¬ì´íŠ¸ì—ì„œ ì„¤ì¹˜
1. https://git-scm.com/download/win ì ‘ì†
2. ë‹¤ìš´ë¡œë“œ í›„ ì„¤ì¹˜ ì‹¤í–‰
3. ê¸°ë³¸ ì„¤ì •ìœ¼ë¡œ ì„¤ì¹˜ ì§„í–‰

#### ë°©ë²• 2: Chocolatey ì‚¬ìš© (ê´€ë¦¬ì ê¶Œí•œ PowerShell)
```powershell
choco install git -y
```

#### ì„¤ì¹˜ í™•ì¸
```powershell
git --version
# ì˜ˆìƒ ì¶œë ¥: git version 2.x.x
```

### 2-2. Git ì‚¬ìš©ì ì •ë³´ ì„¤ì •
```powershell
git config --global user.name "Your Name"
git config --global user.email "your.email@example.com"
```

### 2-3. Git ì €ì¥ì†Œ ì´ˆê¸°í™”
```powershell
# í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ë¡œ ì´ë™
cd C:\FTP

# Git ì €ì¥ì†Œ ì´ˆê¸°í™”
git init

# ê¸°ë³¸ ë¸Œëœì¹˜ë¥¼ mainìœ¼ë¡œ ì„¤ì •
git branch -M main
```

---

## 3. í”„ë¡œì íŠ¸ íŒŒì¼ ì •ë¦¬ ë° ì»¤ë°‹

### 3-1. .gitignore íŒŒì¼ ìƒì„±

`.gitignore` íŒŒì¼ì„ ìƒì„±í•˜ì—¬ ë¶ˆí•„ìš”í•œ íŒŒì¼ì„ Gitì—ì„œ ì œì™¸í•©ë‹ˆë‹¤.

```gitignore
# ìš´ì˜ì²´ì œ íŒŒì¼
.DS_Store
Thumbs.db
desktop.ini

# ì—ë””í„° ì„¤ì •
.vscode/
.idea/
*.swp
*.swo

# ë¡œê·¸ íŒŒì¼
*.log

# ì„ì‹œ íŒŒì¼
*.tmp
*.temp
~$*

# í™˜ê²½ ì„¤ì • íŒŒì¼ (ë¯¼ê° ì •ë³´ í¬í•¨ ê°€ëŠ¥)
.env
.env.local
config.local.php

# ì—…ë¡œë“œëœ íŒŒì¼
public/images/uploads/*
public/uploads/*
!public/images/uploads/.gitkeep

# ì•…ì„± ì½”ë“œ ìƒ˜í”Œ (ë³´ì•ˆìƒ ì œì™¸)
20251117_MalwareSample_30/
ì•…ì„±íŒŒì¼ìƒ˜í”Œ_30_20251117/

# ì¼ì§€ íŒŒì¼ (ì„ íƒì  ì œì™¸)
daily-logs/
```

### 3-2. ì´ˆê¸° ì»¤ë°‹

```powershell
# ëª¨ë“  íŒŒì¼ ì¶”ê°€ (gitignore ì œì™¸)
git add .

# ì²« ì»¤ë°‹
git commit -m "ì´ˆê¸° í”„ë¡œì íŠ¸ êµ¬ì¡° ì„¤ì •

- ë©”ì¸ í˜ì´ì§€ (index.html)
- ì„¸ê³„ ì‹œê°„ í˜ì´ì§€ (world_time.html)
- ë””ìŠ¤í¬ ì •ë³´ í˜ì´ì§€ (disk_info.php)
- ê°¤ëŸ¬ë¦¬ í˜ì´ì§€ (gallery.php)
- ë°°í¬ ê°€ì´ë“œ ë¬¸ì„œ"

# ì»¤ë°‹ í™•ì¸
git log --oneline
```

---

## 4. ì›ê²© Git ì €ì¥ì†Œ ì—°ê²°

### 4-1. GitHub ì €ì¥ì†Œ ìƒì„±

1. GitHub.com ë¡œê·¸ì¸
2. ìš°ì¸¡ ìƒë‹¨ `+` â†’ `New repository` í´ë¦­
3. ì €ì¥ì†Œ ì •ë³´ ì…ë ¥:
   - Repository name: `ftp-web-app` (ì›í•˜ëŠ” ì´ë¦„)
   - Description: `FTP ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜`
   - Public ë˜ëŠ” Private ì„ íƒ
   - **Initialize this repository with README ì²´í¬ í•´ì œ** (ì´ë¯¸ ë¡œì»¬ì— íŒŒì¼ì´ ìˆìœ¼ë¯€ë¡œ)
4. `Create repository` í´ë¦­

### 4-2. ë¡œì»¬ ì €ì¥ì†Œì™€ ì›ê²© ì €ì¥ì†Œ ì—°ê²°

GitHubì—ì„œ ìƒì„± í›„ í‘œì‹œë˜ëŠ” ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ê±°ë‚˜:

```powershell
# ì›ê²© ì €ì¥ì†Œ ì¶”ê°€
git remote add origin https://github.com/ì‚¬ìš©ìëª…/ì €ì¥ì†Œëª….git

# ë˜ëŠ” SSH ì‚¬ìš© ì‹œ
git remote add origin git@github.com:ì‚¬ìš©ìëª…/ì €ì¥ì†Œëª….git

# ì›ê²© ì €ì¥ì†Œ í™•ì¸
git remote -v

# ì²« í‘¸ì‹œ
git push -u origin main
```

### 4-3. GitHub ì¸ì¦

#### HTTPS ì¸ì¦ (Personal Access Token í•„ìš”)
1. GitHub â†’ Settings â†’ Developer settings â†’ Personal access tokens â†’ Tokens (classic)
2. `Generate new token` í´ë¦­
3. ê¶Œí•œ ì„ íƒ: `repo` (ì „ì²´ ì„ íƒ)
4. ìƒì„±ëœ í† í° ë³µì‚¬
5. í‘¸ì‹œ ì‹œ ë¹„ë°€ë²ˆí˜¸ ëŒ€ì‹  í† í° ì…ë ¥

#### SSH ì¸ì¦ (ê¶Œì¥)
```powershell
# SSH í‚¤ ìƒì„±
ssh-keygen -t ed25519 -C "your.email@example.com"

# ê³µê°œí‚¤ ë³µì‚¬
Get-Content ~\.ssh\id_ed25519.pub | clip

# GitHubì— SSH í‚¤ ë“±ë¡
# GitHub â†’ Settings â†’ SSH and GPG keys â†’ New SSH key
# ë³µì‚¬í•œ ê³µê°œí‚¤ë¥¼ ë¶™ì—¬ë„£ê¸°
```

---

## 5. ì„œë²„ ì¤€ë¹„ (ë°°í¬ ì‚¬ìš©ì ë° ë””ë ‰í† ë¦¬)

ë¦¬ëˆ…ìŠ¤ ì„œë²„ì—ì„œ ë‹¤ìŒ ì‘ì—…ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.

### 5-1. ë°°í¬ ì‚¬ìš©ì ìƒì„±

```bash
# ë°°í¬ ì „ìš© ì‚¬ìš©ì ìƒì„±
sudo adduser deploy

# sudo ê¶Œí•œ ë¶€ì—¬ (ì„ íƒì‚¬í•­, ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ì—ì„œ sudo í•„ìš” ì‹œ)
sudo usermod -aG sudo deploy

# deploy ì‚¬ìš©ìë¡œ ì „í™˜
su - deploy
```

### 5-2. SSH í‚¤ ë“±ë¡ (ë¬´ì•”í˜¸ ì ‘ì†)

#### Windowsì—ì„œ SSH í‚¤ ìƒì„±
```powershell
# ë°°í¬ ì „ìš© SSH í‚¤ ìƒì„±
ssh-keygen -t ed25519 -f deploy_key -C "deploy@server"
# deploy_key (ê°œì¸í‚¤)
# deploy_key.pub (ê³µê°œí‚¤)
```

#### ë¦¬ëˆ…ìŠ¤ ì„œë²„ì—ì„œ ê³µê°œí‚¤ ë“±ë¡
```bash
# deploy ì‚¬ìš©ìì˜ SSH ë””ë ‰í† ë¦¬ ìƒì„±
sudo mkdir -p /home/deploy/.ssh
sudo chmod 700 /home/deploy/.ssh

# ê³µê°œí‚¤ ì¶”ê°€ (Windowsì—ì„œ deploy_key.pub ë‚´ìš© ë³µì‚¬)
sudo nano /home/deploy/.ssh/authorized_keys
# ê³µê°œí‚¤ ë‚´ìš© ë¶™ì—¬ë„£ê¸°

# ê¶Œí•œ ì„¤ì •
sudo chown -R deploy:deploy /home/deploy/.ssh
sudo chmod 600 /home/deploy/.ssh/authorized_keys

# í…ŒìŠ¤íŠ¸ (Windowsì—ì„œ)
# ssh -i deploy_key deploy@ì„œë²„IP
```

### 5-3. ë°°í¬ ë””ë ‰í† ë¦¬ ìƒì„±

```bash
# ë°°í¬ ë””ë ‰í† ë¦¬ êµ¬ì¡° ìƒì„±
sudo mkdir -p /var/www/myapp/{releases,shared,repo}

# ê¶Œí•œ ì„¤ì •
sudo chown -R deploy:deploy /var/www/myapp
sudo chmod -R 755 /var/www/myapp

# ë””ë ‰í† ë¦¬ êµ¬ì¡° í™•ì¸
tree /var/www/myapp
```

### 5-4. Git ì„¤ì¹˜ ë° ì´ˆê¸° í´ë¡ 

```bash
# Git ì„¤ì¹˜
sudo apt update
sudo apt install git -y

# deploy ì‚¬ìš©ìë¡œ Git ì €ì¥ì†Œ í´ë¡ 
sudo -u deploy git clone https://github.com/ì‚¬ìš©ìëª…/ì €ì¥ì†Œëª….git /var/www/myapp/repo

# ë˜ëŠ” SSH ì‚¬ìš© ì‹œ
sudo -u deploy git clone git@github.com:ì‚¬ìš©ìëª…/ì €ì¥ì†Œëª….git /var/www/myapp/repo
```

### 5-5. Nginx ì„¤ì • ìˆ˜ì •

```bash
# Nginx ì„¤ì • íŒŒì¼ í¸ì§‘
sudo nano /etc/nginx/sites-available/default

# root ë””ë ‰í† ë¦¬ ë³€ê²½
server {
    listen 80;
    server_name _;
    root /var/www/myapp/current/public;  # ë³€ê²½
    index index.php index.html;
    
    location / {
        try_files $uri $uri/ =404;
    }
    
    location ~ \.php$ {
        include snippets/fastcgi-php.conf;
        fastcgi_pass unix:/var/run/php/php8.1-fpm.sock;
    }
}

# Nginx ì„¤ì • í…ŒìŠ¤íŠ¸
sudo nginx -t

# Nginx ì¬ì‹œì‘
sudo systemctl reload nginx

# ì´ˆê¸° current ì‹¬ë³¼ë¦­ ë§í¬ ìƒì„±
sudo -u deploy ln -s /var/www/myapp/repo/public /var/www/myapp/current
```

---

## 6. ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±

### 6-1. ì„œë²„ ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ (`deploy/deploy.sh`)

```bash
#!/bin/bash
set -e

# ì„¤ì • ë³€ìˆ˜
APP_DIR="/var/www/myapp"
REPO_DIR="$APP_DIR/repo"
RELEASES_DIR="$APP_DIR/releases"
SHARED_DIR="$APP_DIR/shared"
TIMESTAMP=$(date +"%Y%m%d_%H%M%S")
NEW_RELEASE="$RELEASES_DIR/$TIMESTAMP"
CURRENT_LINK="$APP_DIR/current"

# ë¡œê·¸ í•¨ìˆ˜
log() {
    echo "[$(date '+%Y-%m-%d %H:%M:%S')] $1"
}

log "ğŸš€ ë°°í¬ ì‹œì‘: $TIMESTAMP"

# Git ì €ì¥ì†Œ ì—…ë°ì´íŠ¸
log "ğŸ“¥ Git ì €ì¥ì†Œ ì—…ë°ì´íŠ¸ ì¤‘..."
cd "$REPO_DIR"
git fetch origin
git checkout main
git pull origin main

# ìƒˆ ë¦´ë¦¬ì¦ˆ ë””ë ‰í† ë¦¬ ìƒì„±
log "ğŸ“¦ ìƒˆ ë¦´ë¦¬ì¦ˆ ë””ë ‰í† ë¦¬ ìƒì„±: $NEW_RELEASE"
mkdir -p "$NEW_RELEASE"

# íŒŒì¼ ë³µì‚¬ (public ë””ë ‰í† ë¦¬)
log "ğŸ“‹ íŒŒì¼ ë³µì‚¬ ì¤‘..."
rsync -a --exclude=".git" "$REPO_DIR/public/" "$NEW_RELEASE/"

# ê³µìœ  íŒŒì¼/ë””ë ‰í† ë¦¬ ë§í¬ (í•„ìš”ì‹œ)
if [ -d "$SHARED_DIR/uploads" ]; then
    log "ğŸ”— ê³µìœ  ë””ë ‰í† ë¦¬ ë§í¬ ìƒì„±..."
    rm -rf "$NEW_RELEASE/uploads"
    ln -s "$SHARED_DIR/uploads" "$NEW_RELEASE/uploads"
fi

# PHP Composer ì„¤ì¹˜ (composer.jsonì´ ìˆëŠ” ê²½ìš°)
if [ -f "$REPO_DIR/composer.json" ]; then
    log "ğŸ“¦ Composer ì˜ì¡´ì„± ì„¤ì¹˜ ì¤‘..."
    cd "$NEW_RELEASE"
    composer install --no-dev --optimize-autoloader
fi

# ì‹¬ë³¼ë¦­ ë§í¬ êµì²´ (ì›ìì  ë°°í¬)
log "ğŸ”„ ì‹¬ë³¼ë¦­ ë§í¬ êµì²´ ì¤‘..."
ln -sfn "$NEW_RELEASE" "$CURRENT_LINK"

# PHP-FPM ì¬ì‹œì‘ (í•„ìš”ì‹œ)
log "ğŸ”„ PHP-FPM ì¬ì‹œì‘ ì¤‘..."
sudo systemctl reload php8.1-fpm || true

# Nginx ì¬ì‹œì‘
log "ğŸ”„ Nginx ì¬ì‹œì‘ ì¤‘..."
sudo nginx -t && sudo systemctl reload nginx

# ì´ì „ ë¦´ë¦¬ì¦ˆ ì •ë¦¬ (ìµœê·¼ 5ê°œë§Œ ìœ ì§€)
log "ğŸ§¹ ì˜¤ë˜ëœ ë¦´ë¦¬ì¦ˆ ì •ë¦¬ ì¤‘..."
cd "$RELEASES_DIR"
ls -t | tail -n +6 | xargs -r rm -rf

log "âœ… ë°°í¬ ì™„ë£Œ: $TIMESTAMP"
log "ğŸ“ í˜„ì¬ ë¦´ë¦¬ì¦ˆ: $NEW_RELEASE"
```

### 6-2. ìŠ¤í¬ë¦½íŠ¸ ê¶Œí•œ ì„¤ì •

```bash
# ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ì„ ì„œë²„ë¡œ ì „ì†¡í•œ í›„
sudo chown deploy:deploy /var/www/myapp/deploy.sh
sudo chmod +x /var/www/myapp/deploy.sh

# í…ŒìŠ¤íŠ¸ ì‹¤í–‰
sudo -u deploy /var/www/myapp/deploy.sh
```

---

## 7. GitHub Actions CI/CD ì„¤ì •

### 7-1. GitHub Secrets ë“±ë¡

1. GitHub ì €ì¥ì†Œ â†’ `Settings` â†’ `Secrets and variables` â†’ `Actions`
2. `New repository secret` í´ë¦­í•˜ì—¬ ë‹¤ìŒ Secrets ì¶”ê°€:

| Secret ì´ë¦„ | ì„¤ëª… | ì˜ˆì‹œ |
|------------|------|------|
| `DEPLOY_HOST` | ì„œë²„ IP ì£¼ì†Œ | `192.168.1.100` |
| `DEPLOY_USER` | ë°°í¬ ì‚¬ìš©ìëª… | `deploy` |
| `DEPLOY_KEY` | SSH ê°œì¸í‚¤ (ì „ì²´ ë‚´ìš©) | `-----BEGIN OPENSSH PRIVATE KEY-----...` |
| `DEPLOY_PATH` | ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ ê²½ë¡œ | `/var/www/myapp/deploy.sh` |

**SSH ê°œì¸í‚¤ ì „ì²´ ë‚´ìš© ë³µì‚¬:**
```powershell
# Windowsì—ì„œ
Get-Content deploy_key | clip
# GitHub Secretsì˜ DEPLOY_KEYì— ë¶™ì—¬ë„£ê¸°
```

### 7-2. GitHub Actions ì›Œí¬í”Œë¡œìš° íŒŒì¼ ìƒì„±

`.github/workflows/deploy.yml` íŒŒì¼ ìƒì„±:

```yaml
name: Deploy to Production Server

on:
  push:
    branches: [ "main" ]
  workflow_dispatch:  # ìˆ˜ë™ ì‹¤í–‰ ê°€ëŠ¥

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
      - name: ğŸ“¥ ì½”ë“œ ì²´í¬ì•„ì›ƒ
        uses: actions/checkout@v3
      
      - name: ğŸ” SSH í‚¤ ì„¤ì •
        run: |
          mkdir -p ~/.ssh
          echo "${{ secrets.DEPLOY_KEY }}" > ~/.ssh/deploy_key
          chmod 600 ~/.ssh/deploy_key
          ssh-keyscan -H ${{ secrets.DEPLOY_HOST }} >> ~/.ssh/known_hosts
      
      - name: ğŸš€ ì„œë²„ ë°°í¬ ì‹¤í–‰
        uses: appleboy/ssh-action@v1.0.3
        with:
          host: ${{ secrets.DEPLOY_HOST }}
          username: ${{ secrets.DEPLOY_USER }}
          key: ~/.ssh/deploy_key
          script: |
            cd /var/www/myapp
            ./deploy.sh
      
      - name: âœ… ë°°í¬ ì™„ë£Œ ì•Œë¦¼
        run: |
          echo "ë°°í¬ê°€ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!"
          echo "ì„œë²„: ${{ secrets.DEPLOY_HOST }}"
```

### 7-3. ì›Œí¬í”Œë¡œìš° íŒŒì¼ ì»¤ë°‹ ë° í‘¸ì‹œ

```powershell
# íŒŒì¼ ì¶”ê°€
git add .github/workflows/deploy.yml

# ì»¤ë°‹
git commit -m "CI/CD íŒŒì´í”„ë¼ì¸ ì¶”ê°€

- GitHub Actions ìë™ ë°°í¬ ì„¤ì •
- main ë¸Œëœì¹˜ í‘¸ì‹œ ì‹œ ìë™ ë°°í¬"

# í‘¸ì‹œ (ì´ í‘¸ì‹œë¶€í„° ìë™ ë°°í¬ ì‹œì‘!)
git push origin main
```

### 7-4. GitHub Actions ì‹¤í–‰ í™•ì¸

1. GitHub ì €ì¥ì†Œ â†’ `Actions` íƒ­
2. ì›Œí¬í”Œë¡œìš° ì‹¤í–‰ ìƒíƒœ í™•ì¸
3. ë¡œê·¸ í™•ì¸í•˜ì—¬ ë°°í¬ ì„±ê³µ ì—¬ë¶€ í™•ì¸

---

## 8. ìë™ ë°°í¬ í…ŒìŠ¤íŠ¸

### 8-1. ê°„ë‹¨í•œ ë³€ê²½ì‚¬í•­ ì ìš©

```powershell
# index.html íŒŒì¼ ìˆ˜ì • (ì˜ˆ: ì œëª© ë³€ê²½)
# ë˜ëŠ” ìƒˆ íŒŒì¼ ì¶”ê°€

# ë³€ê²½ì‚¬í•­ ì»¤ë°‹
git add .
git commit -m "í…ŒìŠ¤íŠ¸: ìë™ ë°°í¬ í™•ì¸"

# í‘¸ì‹œ (ìë™ìœ¼ë¡œ ë°°í¬ ì‹œì‘)
git push origin main
```

### 8-2. ë°°í¬ í™•ì¸

1. **GitHub Actions ë¡œê·¸ í™•ì¸**
   - ì €ì¥ì†Œ â†’ Actions íƒ­ â†’ ìµœì‹  ì›Œí¬í”Œë¡œìš° ì‹¤í–‰ í´ë¦­
   - ê° ë‹¨ê³„ë³„ ë¡œê·¸ í™•ì¸

2. **ì„œë²„ì—ì„œ í™•ì¸**
   ```bash
   # ì„œë²„ì— SSH ì ‘ì†
   ssh deploy@ì„œë²„IP
   
   # ë¦´ë¦¬ì¦ˆ ë””ë ‰í† ë¦¬ í™•ì¸
   ls -la /var/www/myapp/releases/
   
   # í˜„ì¬ ì‹¬ë³¼ë¦­ ë§í¬ í™•ì¸
   ls -la /var/www/myapp/current
   
   # ìµœì‹  íŒŒì¼ ë‚´ìš© í™•ì¸
   cat /var/www/myapp/current/public/index.html | head -10
   ```

3. **ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ í™•ì¸**
   - ì„œë²„ IPë¡œ ì ‘ì†í•˜ì—¬ ë³€ê²½ì‚¬í•­ í™•ì¸

---

## 9. ìˆ˜ë™ ë°°í¬ ë°©ë²• (Git ì—†ì„ ë•Œ)

Gitì´ ì„¤ì¹˜ë˜ì–´ ìˆì§€ ì•Šê±°ë‚˜, ë¹ ë¥¸ ìˆ˜ì •ì´ í•„ìš”í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ìˆ˜ë™ ë°°í¬ ë°©ë²•ì…ë‹ˆë‹¤.

### 9-1. FTPë¥¼ ì´ìš©í•œ ìˆ˜ë™ ë°°í¬

#### Windowsì—ì„œ ë°°í¬ íŒŒì¼ ì¤€ë¹„
```powershell
# ë°°í¬í•  íŒŒì¼ë“¤ì„ deploy_queue ë””ë ‰í† ë¦¬ì— ë³µì‚¬
New-Item -ItemType Directory -Force -Path "$HOME\deploy_queue"

# ë³€ê²½ëœ íŒŒì¼ ë³µì‚¬
Copy-Item -Path "public\index.html" -Destination "$HOME\deploy_queue\index.html"
Copy-Item -Path "public\world_time.html" -Destination "$HOME\deploy_queue\world_time.html"
```

#### ë¦¬ëˆ…ìŠ¤ ì„œë²„ì—ì„œ FTPë¡œ íŒŒì¼ ë‹¤ìš´ë¡œë“œ
```bash
# FTP ì ‘ì†
ftp <ìœˆë„ìš°_IP>
# ì‚¬ìš©ìëª…ê³¼ ë¹„ë°€ë²ˆí˜¸ ì…ë ¥

# ë°°í¬ í ë””ë ‰í† ë¦¬ë¡œ ì´ë™
cd deploy_queue

# íŒŒì¼ ë‹¤ìš´ë¡œë“œ
binary
get index.html
get world_time.html
quit
```

#### ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
```bash
# ê¸°ì¡´ ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ ì‚¬ìš©
~/deploy_files.sh

# ë˜ëŠ” ìˆ˜ë™ ë°°í¬
sudo cp ~/deploy_queue/*.html /var/www/myapp/current/public/
sudo chown -R www-data:www-data /var/www/myapp/current/public/
sudo systemctl reload nginx
```

### 9-2. SCPë¥¼ ì´ìš©í•œ ì§ì ‘ ë°°í¬

```powershell
# Windows PowerShellì—ì„œ
scp public\*.html deploy@ì„œë²„IP:/tmp/
scp public\*.php deploy@ì„œë²„IP:/tmp/

# ì„œë²„ì—ì„œ ë°°í¬
ssh deploy@ì„œë²„IP "sudo cp /tmp/*.html /var/www/myapp/current/public/ && sudo systemctl reload nginx"
```

### 9-3. ìˆ˜ë™ ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ (`deploy/manual_deploy.sh`)

```bash
#!/bin/bash
# ìˆ˜ë™ ë°°í¬ ìŠ¤í¬ë¦½íŠ¸

DEPLOY_QUEUE="$HOME/deploy_queue"
WEB_ROOT="/var/www/myapp/current/public"

if [ ! -d "$DEPLOY_QUEUE" ]; then
    echo "âŒ ë°°í¬ í ë””ë ‰í† ë¦¬ê°€ ì—†ìŠµë‹ˆë‹¤: $DEPLOY_QUEUE"
    exit 1
fi

# íŒŒì¼ í™•ì¸
files=$(find "$DEPLOY_QUEUE" -type f \( -name "*.html" -o -name "*.php" -o -name "*.css" -o -name "*.js" \))

if [ -z "$files" ]; then
    echo "âŒ ë°°í¬í•  íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤."
    exit 0
fi

echo "ğŸ“¦ ë°°í¬ ì‹œì‘..."

# íŒŒì¼ ë³µì‚¬
for file in $files; do
    filename=$(basename "$file")
    echo "  â†’ ë°°í¬ ì¤‘: $filename"
    sudo cp "$file" "$WEB_ROOT/$filename"
    sudo chown www-data:www-data "$WEB_ROOT/$filename"
    sudo chmod 644 "$WEB_ROOT/$filename"
done

# Nginx ì¬ì‹œì‘
echo "ğŸ”„ Nginx ì¬ì‹œì‘ ì¤‘..."
sudo systemctl reload nginx

# ë°°í¬ í ë¹„ìš°ê¸°
rm -f "$DEPLOY_QUEUE"/*

echo "âœ… ìˆ˜ë™ ë°°í¬ ì™„ë£Œ!"
```

---

## ğŸ“ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ì´ˆê¸° ì„¤ì •
- [ ] í”„ë¡œì íŠ¸ êµ¬ì¡° ì •ë¦¬ ì™„ë£Œ
- [ ] Git ì„¤ì¹˜ ì™„ë£Œ
- [ ] Git ì €ì¥ì†Œ ì´ˆê¸°í™” ì™„ë£Œ
- [ ] .gitignore íŒŒì¼ ìƒì„± ì™„ë£Œ
- [ ] ì´ˆê¸° ì»¤ë°‹ ì™„ë£Œ
- [ ] GitHub ì €ì¥ì†Œ ìƒì„± ì™„ë£Œ
- [ ] ì›ê²© ì €ì¥ì†Œ ì—°ê²° ì™„ë£Œ

### ì„œë²„ ì„¤ì •
- [ ] ë°°í¬ ì‚¬ìš©ì(deploy) ìƒì„± ì™„ë£Œ
- [ ] SSH í‚¤ ë“±ë¡ ì™„ë£Œ
- [ ] ë°°í¬ ë””ë ‰í† ë¦¬ ìƒì„± ì™„ë£Œ
- [ ] Git ì„¤ì¹˜ ë° í´ë¡  ì™„ë£Œ
- [ ] Nginx ì„¤ì • ìˆ˜ì • ì™„ë£Œ
- [ ] ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„± ë° ê¶Œí•œ ì„¤ì • ì™„ë£Œ

### CI/CD ì„¤ì •
- [ ] GitHub Secrets ë“±ë¡ ì™„ë£Œ
- [ ] GitHub Actions ì›Œí¬í”Œë¡œìš° íŒŒì¼ ìƒì„± ì™„ë£Œ
- [ ] ì²« ìë™ ë°°í¬ í…ŒìŠ¤íŠ¸ ì„±ê³µ
- [ ] ë°°í¬ í”„ë¡œì„¸ìŠ¤ í™•ì¸ ì™„ë£Œ

---

## ğŸ†˜ ë¬¸ì œ í•´ê²°

### Git ê´€ë ¨
- **ë¬¸ì œ**: `git: command not found`
  - **í•´ê²°**: Git ì„¤ì¹˜ í™•ì¸ ë° PATH í™˜ê²½ë³€ìˆ˜ í™•ì¸

- **ë¬¸ì œ**: `Permission denied (publickey)`
  - **í•´ê²°**: SSH í‚¤ ë“±ë¡ ë° ê¶Œí•œ í™•ì¸

### ë°°í¬ ê´€ë ¨
- **ë¬¸ì œ**: ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ê¶Œí•œ ì—†ìŒ
  - **í•´ê²°**: `chmod +x deploy.sh` ì‹¤í–‰

- **ë¬¸ì œ**: Nginx 502 Bad Gateway
  - **í•´ê²°**: PHP-FPM ìƒíƒœ í™•ì¸ ë° ì‹¬ë³¼ë¦­ ë§í¬ í™•ì¸

- **ë¬¸ì œ**: íŒŒì¼ ê¶Œí•œ ì˜¤ë¥˜
  - **í•´ê²°**: `chown -R www-data:www-data` ì‹¤í–‰

---

## ğŸ¯ ë‹¤ìŒ ë‹¨ê³„

1. **CSS/JS ë¶„ë¦¬ ì‘ì—…**: ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ê³¼ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë³„ë„ íŒŒì¼ë¡œ ë¶„ë¦¬
2. **í™˜ê²½ ë³€ìˆ˜ ê´€ë¦¬**: `.env` íŒŒì¼ì„ í†µí•œ ì„¤ì • ê´€ë¦¬
3. **ë¡¤ë°± ê¸°ëŠ¥ ì¶”ê°€**: ë°°í¬ ì‹¤íŒ¨ ì‹œ ì´ì „ ë²„ì „ìœ¼ë¡œ ìë™ ë¡¤ë°±
4. **ë°°í¬ ì•Œë¦¼**: Slack/Discord ë“±ìœ¼ë¡œ ë°°í¬ ìƒíƒœ ì•Œë¦¼
5. **í…ŒìŠ¤íŠ¸ ìë™í™”**: ë°°í¬ ì „ ìë™ í…ŒìŠ¤íŠ¸ ì‹¤í–‰

---

## ğŸ“š ì°¸ê³  ìë£Œ

- [Git ê³µì‹ ë¬¸ì„œ](https://git-scm.com/doc)
- [GitHub Actions ë¬¸ì„œ](https://docs.github.com/en/actions)
- [Nginx ê³µì‹ ë¬¸ì„œ](https://nginx.org/en/docs/)
- [ë°°í¬ ê°€ì´ë“œ ì›ë³¸](./git_cicd_ë°°í¬ê°€ì´ë“œ.md)

---

**ì‘ì„±ì¼**: 2025ë…„ 1ì›”
**ìµœì¢… ìˆ˜ì •**: 2025ë…„ 1ì›”
